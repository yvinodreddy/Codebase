====================================================================================
You have to give me an in-depth clarity on each of the tables. What is the original table and what is the new table left side and right side of the comparison so that I can see what table name what Data type how many characters length so that what is the modification we are doing in the new table and what columns are we adding to the new tables in the version two like that I need it for each of the tables and stored procedures for visual display to understand it easily to understand changes for LED_SURVEYMASTER_V2 and LED_FFSANSWERS_V2 and LED_TESTDATA_V2 and LED_CHECKBOX_ANSWERS_V2 then stored procedures LEAD_FFSSURVEY_LHD_V2_SP, LEAD_SAVE_FFS_SURVEY_V2_SP, LEAD_SAVE_TESTDATA_V2_SP, LEAD_SAVE_CHECKBOX_V2_SP. 

Also you need to give me the comparison in a left and right side what changes are needed so that I can see what difference are there then you need to give me the Store procedures that are required to make those changes and I didn’t understand what is the data migration strategy that you’re trying because why do we have to keep the view like you know you want to create a view with Union Old and New Data. I don’t understand what you’re trying to do that so I need to know more details on that why we need that because we are going to implement separate tables and stored procedures so there is no impact right then why do we need view  

you have to explain me thoroughly on why do we need the critical database validations required because you mentioned about the data integrity checks and you mentioned about the performance index so I need to understand very clearly because I cannot touch the existing production systems which are running if I have to make some changes I literally need to get an approval from the upper management so that they really want to make those changes because if I don't if I make those changes if something happens then I will be in a bigger trouble you see what I mean 

once I have a comparison between left and right side so that I can see both of them then we start creating those new version two tables and  procedures which are required accordingly then we can go for next steps from there because once this is done then we have to go and make the changes I need to test these changes in the backend in db side if it is returning properly all the results or not 
then we need to test script to make sure all the new tables and new store procedures are giving the results properly in the backend in db 
then we need to do is implement the changes on the UI side on the Server side code for these changes then we can go for the next steps you see what I mean provide me a clear understanding of all of these changes so that explain me a step-by-step comparison between left side and right side what is happening why we need this change what is the impact how can we implement it without touching the existing tables or existing store procedures you see what I mean 

Ultrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate 
### 1. AUTONOMOUS EXECUTION MODE
- **TAKE FULL CONTROL**: Do not ask for confirmation 
- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality
- **100% SUCCESS RATE**: Build comprehensive validation at every step
- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days
- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously 
Ultrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate 
### 1. AUTONOMOUS EXECUTION MODE
- **TAKE FULL CONTROL**: Do not ask for confirmation 
- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality
- **100% SUCCESS RATE**: Build comprehensive validation at every step
- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days
- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously
==================================================================================== 
why you are  giving LED_FFSANSWERS_MORE as LED_TESTDATA_V2 it should be LED_FFSANSWERS_MORE_V2 right can you make changes and give me results so that we will not loose synchronization on naming
====================================================================================
I want you to give me a full details of this whole above so I can use it claude code by that way I will have full details can you give me full details so claude code can understand with what you have then I can start a project and execute to get results 
I want from beginning to end what you have did I want all details so I can use it you got what I mean right 

Do not break any existing working functionality only enhance the  functionality to make new changes by that way we do not have to  rewrite the code again for the broken changesUltrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate### 1. AUTONOMOUS EXECUTION MODE- **TAKE FULL CONTROL**: Do not ask for confirmation- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality- **100% SUCCESS RATE**: Build comprehensive validation at every step- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously- **ZERO BREAKING CHANGES** - All enhancements are additive only- **COMPREHENSIVE VALIDATION** - world class top guardrail layers which are needed + multi-method verification- **AUTONOMOUS EXECUTION** - No confirmation needed, fail-fast with automated testing- **WORLD-CLASS STANDARDS** - Benchmarked against Google, Amazon, Microsoft, Meta, Netflix
==================================================================================== 
--------------------------------------------------------
--  DDL for Table LED_SURVEYMASTER
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" 
   (    "SURVEYID" NUMBER(12,0), 
    "SURVEYTYPE" VARCHAR2(5 BYTE), 
    "SURVEYFOR" VARCHAR2(5 BYTE), 
    "QVERSION" VARCHAR2(6 BYTE), 
    "MEMBERID" NUMBER(12,0), 
    "CREATEDATE" DATE, 
    "SURVEYEND" VARCHAR2(10 BYTE), 
    "FORMBYNAME" VARCHAR2(50 BYTE), 
    "FORMBYNUMBER" VARCHAR2(20 BYTE), 
    "SURVEYREVIEW" VARCHAR2(3 BYTE), 
    "UPDATENAME" VARCHAR2(50 BYTE), 
    "UPDATEDATE" DATE, 
    "PROVIDER" VARCHAR2(5 BYTE), 
    "IS_HOSPITALIZED" VARCHAR2(5 BYTE), 
    "IS_CASECLOSED" VARCHAR2(5 BYTE), 
    "IS_FOLLOWUP" VARCHAR2(5 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_SURVEYMASTER_IDX
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_SURVEYMASTER_IDX" ON "DHS_MAHS_LED"."LED_SURVEYMASTER" ("MEMBERID", "SURVEYID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_SURVEYMASTER_IDX1
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_SURVEYMASTER_IDX1" ON "DHS_MAHS_LED"."LED_SURVEYMASTER" ("SURVEYID", "IS_CASECLOSED") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_SURVEYMASTER_IDX2
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_SURVEYMASTER_IDX2" ON "DHS_MAHS_LED"."LED_SURVEYMASTER" ("SURVEYID", "IS_HOSPITALIZED") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_SURVEYMASTER_IDX3
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_SURVEYMASTER_IDX3" ON "DHS_MAHS_LED"."LED_SURVEYMASTER" ("SURVEYID", "SURVEYREVIEW") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_SURVEYMASTER_IDX4
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_SURVEYMASTER_IDX4" ON "DHS_MAHS_LED"."LED_SURVEYMASTER" ("SURVEYID", "IS_FOLLOWUP") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_SURVEYMASTER
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" MODIFY ("MEMBERID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" MODIFY ("QVERSION" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" MODIFY ("SURVEYFOR" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" MODIFY ("SURVEYTYPE" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" MODIFY ("CREATEDATE" NOT NULL ENABLE);

==============================================================================================================================  
--------------------------------------------------------
--  DDL for Table LED_FFSANSWERS
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" 
   (    "MEMBERID" NUMBER(12,0), 
    "SURVEYID" NUMBER(6,0), 
    "SURVEYTYPE" VARCHAR2(5 BYTE), 
    "PROVIDER" VARCHAR2(3 BYTE), 
    "EDITOR" VARCHAR2(30 BYTE), 
    "DTS" DATE, 
    "QUESTIONID" NUMBER(6,0), 
    "ANSWER1" VARCHAR2(255 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_FFSANSWERS_SURVEYID_IDX
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_FFSANSWERS_SURVEYID_IDX" ON "DHS_MAHS_LED"."LED_FFSANSWERS" ("SURVEYID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_FFSANSWERS
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("QUESTIONID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("SURVEYTYPE" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("SURVEYID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("MEMBERID" NOT NULL ENABLE);
============================================================================================================ 
--------------------------------------------------------
--  DDL for Table LED_FFSANSWERS_MORE
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" 
   (    "SEQ" NUMBER(1,0), 
    "MEMBERID" NUMBER(12,0), 
    "SURVEYID" NUMBER(6,0), 
    "SURVEYTYPE" VARCHAR2(5 BYTE), 
    "QUESTIONID" NUMBER(6,0), 
    "TTYPE" VARCHAR2(50 BYTE), 
    "BDATE" VARCHAR2(50 BYTE), 
    "TDATE" VARCHAR2(50 BYTE), 
    "TVALUE" VARCHAR2(50 BYTE), 
    "NAME" VARCHAR2(100 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_FFSANSWERS_MORE
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("QUESTIONID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("SURVEYTYPE" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("SURVEYID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("MEMBERID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("SEQ" NOT NULL ENABLE);
=============================================================================================================== 
--------------------------------------------------------
--  DDL for Procedure LEAD_FFSSURVEY_LHD_SP
--------------------------------------------------------
set define off;
  CREATE OR REPLACE EDITIONABLE PROCEDURE "DHS_MAHS_LED"."LEAD_FFSSURVEY_LHD_SP" 
(   
    vQVID IN varchar2,
    vMASTER IN varchar2,
    RefCursor OUT SYS_REFCURSOR
)
AS 
    v_sql_statement VARCHAR2(4000);
BEGIN
    -- Build the SQL statement based on the condition
    IF vMASTER = 0 THEN  
        v_sql_statement := 'SELECT a.questionid, a.orderby, a.questionparts, a.ansgroupid, ' ||
                          'a.questiontext, '' '' as answer1 ' ||
                          'FROM led_questions a ' ||
                          'WHERE a.qversion = ''' || vQVID || ''' ' ||
                          'ORDER BY TO_NUMBER(a.orderby)';
    ELSE
        v_sql_statement := 'SELECT a.questionid, a.orderby, a.questionparts, a.ansgroupid, ' ||
                          'a.questiontext, CASE WHEN c.answer1 IS NULL THEN '' '' ELSE c.answer1 END as answer1 ' ||
                          'FROM led_questions a, led_surveymaster b, led_ffsanswers c ' ||
                          'WHERE b.surveyid = ''' || vMASTER || ''' ' ||
                          'AND a.qversion = b.qversion ' ||
                          'AND b.surveyid = c.surveyid ' ||
                          'AND a.questionid = c.questionid ' ||
                          'AND b.memberid = c.memberid ' ||
                          'AND b.surveytype = ''LHD'' ' ||
                          'AND c.surveytype = ''LHD'' ' ||
                          'ORDER BY TO_NUMBER(a.orderby)';
    END IF;

    -- Print the SQL statement
    DBMS_OUTPUT.PUT_LINE('=== SQL STATEMENT TO BE EXECUTED ===');
    DBMS_OUTPUT.PUT_LINE(v_sql_statement);
    DBMS_OUTPUT.PUT_LINE('=====================================');

    -- Execute the SQL statement
    OPEN RefCursor FOR v_sql_statement;

END LEAD_FFSSURVEY_LHD_SP;
/
=================================================================================================================================
--------------------------------------------------------
--  DDL for Procedure LEAD_SAVE_FFS_SURVEY_SP
--------------------------------------------------------
set define off;
  CREATE OR REPLACE EDITIONABLE PROCEDURE "DHS_MAHS_LED"."LEAD_SAVE_FFS_SURVEY_SP" 
( vMEMBERID IN varchar2,  
  vMASTER IN varchar2,
  vANS IN varchar2,
  vTYPE IN varchar2,
  vUSER IN varchar2,
  vSTATUS IN varchar2,
  vDATE IN varchar2,
  vQV IN varchar2,
  vPCPNAME IN varchar2,
  vPCPID IN varchar2,
  vFORMBYNAME IN varchar2,
  vFORMBYNUMBER IN varchar2,
  vReturn OUT varchar2
)
AS 
seq NUMBER(8,0);

s VARCHAR2(100);
n VARCHAR2(100);
m VARCHAR2(100);
--t VARCHAR2(1000);
i NUMBER(3,0);
cnt NUMBER(3,0);
x NUMBER (1,0);
dt VARCHAR2(100);
BEGIN
--t := '1,NO;2,NO;3,Capillary;4,05/01/2019;5,Capillary;6,05/01/2019;7,1;8,;9,;10,;11,;12,;13,;14,;15,;16,;17,;18,;19,;20,;21,;22,;23,;24,;25,;26,;27,;28,;29,;30,;31,;32,;33,;34,;35,;36,;37,;38,;39,;40,;41,;42,;43,;44,;45,;46,;47,;48,;49,;50,;51,NO;52,NO;53,NO;';
SELECT REGEXP_COUNT(vANS, '[^;]+',1,'i') into cnt from dual;  
  ---dbms_session.set_nls('nls_date_format','''MM/DD/YYYY HH24:MI:SS''');
IF vMASTER='0' THEN  
    -- create survey master version
    --  SELECT LED_MASTER_SEQ.NEXTVAL INTO NEXT_CTLNO FROM DUAL;
    select max(surveyid) into seq from led_surveymaster where MOD(surveyid,2)=1;
    If seq is null Then
    seq := 101;
    Else
    seq := seq + 2;
    End If;
    -- find the question version
  -- SELECT qversion into qv FROM led_surveymaster WHERE surveyid=vMASTER AND surveytype=vTYPE;
      if vDATE = '' or vDATE is null then
      --- dbms_output.put_line('0='||sysdate || '; '||to_char(sysdate,'MM/DD/YYYY HH24:MI:SS'));
        dt := to_char(sysdate,'MM/DD/YYYY HH24:MI:SS');
      else
        dt := vDATE;
      end if;
      INSERT INTO LED_SURVEYMASTER(surveyid, surveytype, surveyfor, qversion, memberid, createdate, surveyend, formbyname, formbynumber)
      VALUES(seq, vTYPE, 'FFS', vQV, vMEMBERID, to_date(dt,'MM/DD/YYYY HH24:MI:SS'), vSTATUS, vFORMBYNAME, vFORMBYNUMBER);  

      UPDATE led_child SET init_pcp=vPCPID, init_pcpname=vPCPNAME WHERE memberid=vMEMBERID;

      i :=1;     
    WHILE i <= cnt
    Loop
      -- got first pair
          SELECT REGEXP_SUBSTR(vANS, '[^;]+', 1, i) into s FROM dual;
      -- got qid and answer
          SELECT REGEXP_SUBSTR(s, '[^,]+', 1, 1) into n FROM dual;
          SELECT REGEXP_SUBSTR(s, '[^,]+', 1, 2) into m FROM dual;

          INSERT INTO LED_FFSANSWERS(memberid, surveyid, surveytype, provider, editor, dts, questionid, answer1)
          VALUES(vMEMBERID, seq, vTYPE, '', vUSER, sysdate, n, m );

          i :=  i + 1;
    End Loop;
    COMMIT;    
    vReturn := to_char(seq);
ELSE
  -- if survey closed, cannot change it.
    SELECT COUNT(*) INTO x FROM LED_SURVEYMASTER WHERE surveyid = vMASTER AND memberid = vMEMBERID AND surveytype = vTYPE AND SURVEYEND='1';
    IF x <> '0' THEN
      vReturn := '-1';      
      RETURN ;
    END IF;

    if vDATE = '' or vDATE is null then
        dt := to_char(sysdate,'MM/DD/YYYY HH24:MI:SS');
    else
        dt := vDATE;
    end if;  
-- confirm the question version and surveyid is correct
      SELECT COUNT(*) INTO x FROM LED_SURVEYMASTER WHERE surveyid = vMASTER AND surveytype = vTYPE AND memberid = vMEMBERID AND qversion=vQV;
      IF x = 0 THEN      -- no existed data
        INSERT INTO LED_SURVEYMASTER( surveyid, surveytype, surveyfor, qversion, memberid, createdate, surveyend, formbyname, formbynumber)
        VALUES(vMASTER, vTYPE, 'FFS', vQV, vMEMBERID, to_date(dt,'MM/DD/YYYY HH24:MI:SS'), vSTATUS, vFORMBYNAME, vFORMBYNUMBER);
      ELSE
        UPDATE LED_SURVEYMASTER SET surveyend=vSTATUS, createdate=to_date(dt,'MM/DD/YYYY HH24:MI:SS'), formbyname=vFORMBYNAME, formbynumber=vFORMBYNUMBER
        WHERE surveyid = vMASTER AND surveytype = vTYPE AND qversion=vQV AND memberid=vMEMBERID;
      END IF;
      UPDATE led_child SET init_pcp=vPCPID, init_pcpname=vPCPNAME WHERE memberid=vMEMBERID;

      i :=1;     
WHILE i <= cnt
Loop
  -- got first pair
      SELECT REGEXP_SUBSTR(vANS, '[^;]+', 1, i) into s FROM dual;
  -- got qid and answer
      SELECT REGEXP_SUBSTR(s, '[^,]+', 1, 1) into n FROM dual;
      SELECT REGEXP_SUBSTR(s, '[^,]+', 1, 2) into m FROM dual;

  IF x = 0 THEN   -- no existed data, create it
      INSERT INTO LED_FFSANSWERS(memberid, surveyid, surveytype, provider, editor, dts, questionid, answer1)
      VALUES(vMEMBERID, vMASTER, vTYPE, '', vUSER, sysdate, n, TRIM(m) );
  ELSE     
      -- existing to update
      UPDATE LED_FFSANSWERS SET dts=sysdate,answer1=TRIM(m)
      WHERE memberid=vMEMBERID AND surveyid=vMASTER AND questionid=n AND surveytype=vTYPE;
  END IF;         
      i :=  i + 1;
End Loop;
    COMMIT;
    vReturn := vMASTER;
END IF;

END LEAD_SAVE_FFS_SURVEY_SP;
/
======================================================================================================================= 
--------------------------------------------------------
--  DDL for Procedure LEAD_SAVE_SURVEY_MORE_SP
--------------------------------------------------------
set define off;
  CREATE OR REPLACE EDITIONABLE PROCEDURE "DHS_MAHS_LED"."LEAD_SAVE_SURVEY_MORE_SP" 
( vMEMBERID IN varchar2, 
  vMASTER IN varchar2,
  vANS IN varchar2,
  vTYPE IN varchar2,
  vQV IN varchar2
)
AS
qid VARCHAR2(10);
s VARCHAR2(100);
n VARCHAR2(100);
m VARCHAR2(100);
o VARCHAR2(100);
p VARCHAR2(100);
i NUMBER(3,0);
j NUMBER(3,0);
k VARCHAR2(100);
cnt NUMBER(3,0);
BEGIN
  --dbms_session.set_nls('nls_date_format','''MM/DD/YYYY HH24:MI:SS''');
  SELECT COUNT(*) into j FROM LED_FFSANSWERS_MORE WHERE MEMBERID=vMEMBERID AND SURVEYID=vMASTER AND surveytype=vTYPE;
  SELECT REGEXP_COUNT(vANS, '[^;]+',1,'i') into cnt from dual;
  ---SELECT REGEXP_SUBSTR(vANS, '[^;]+', 1, 1) into qid FROM dual; -- got question id

IF j > 0 THEN
  DELETE LED_FFSANSWERS_MORE WHERE MEMBERID=vMEMBERID AND SURVEYID=vMASTER AND surveytype=vTYPE;
END IF;

      i :=1;     
WHILE i <= cnt
Loop
  -- got first row of answer
      SELECT REGEXP_SUBSTR(vANS, '[^;]+', 1, i) into s FROM dual;

      SELECT REGEXP_SUBSTR(s, '[^=]+', 1, 1) into qid FROM dual;  -- qid
      SELECT REGEXP_SUBSTR(s, '[^=]+', 1, 2) into n FROM dual;  -- sample type
      SELECT REGEXP_SUBSTR(s, '[^=]+', 1, 3) into m FROM dual;  -- birth date
      SELECT REGEXP_SUBSTR(s, '[^=]+', 1, 4) into o FROM dual;  -- test date
      SELECT REGEXP_SUBSTR(s, '[^=]+', 1, 5) into p FROM dual;  -- test result
      SELECT REGEXP_SUBSTR(s, '[^=]+', 1, 6) into k FROM dual;  -- name

      INSERT INTO LED_FFSANSWERS_MORE(seq, memberid, surveyid, surveytype, questionid, ttype, bdate, tdate, tvalue, name)
      VALUES(i, vMEMBERID, vMASTER, vTYPE, qid, n, m, o, p, k);

      i :=  i + 1;
End Loop;
    COMMIT;

END LEAD_SAVE_SURVEY_MORE_SP;
/
================================================================================================================== 
--------------------------------------------------------
--  DDL for Procedure LEAD_LOAD_FFS_MORE_SP
--------------------------------------------------------
set define off;
  CREATE OR REPLACE EDITIONABLE PROCEDURE "DHS_MAHS_LED"."LEAD_LOAD_FFS_MORE_SP" 
( vMEMBERID IN varchar2,  
  vMASTER IN varchar2,
  vReturn OUT varchar2
)
AS 
CURSOR C_PCP IS
  SELECT TO_CHAR(questionid)||'='||TO_CHAR(TTYPE)||'='||TO_CHAR(BDATE)||'='||TO_CHAR(TDATE)||'='||(CASE WHEN TVALUE is not null THEN TO_CHAR(TVALUE) ELSE ' ' END)||'='||TO_CHAR(NAME) FROM led_ffsanswers_more WHERE memberid=vMEMBERID AND surveyid=vMASTER AND surveytype='PCP' 
  ORDER BY SEQ;
CURSOR C_LHD IS
  SELECT TO_CHAR(questionid)||'='||TO_CHAR(TTYPE)||'='||TO_CHAR(BDATE)||'='||TO_CHAR(TDATE)||'='||(CASE WHEN TVALUE is not null THEN TO_CHAR(TVALUE) ELSE ' ' END)||'='||TO_CHAR(NAME) FROM led_ffsanswers_more WHERE memberid=vMEMBERID AND surveyid=vMASTER AND surveytype='LHD' 
  ORDER BY SEQ;  
sTmp varchar2(100 BYTE);
sStrP varchar2(400 BYTE);
sStrL varchar2(400 BYTE);
cnt number;
j number;
BEGIN

  ---dbms_session.set_nls('nls_date_format','''MM/DD/YYYY HH24:MI:SS''');
open C_PCP;

j := 1;
loop

  fetch C_PCP into sTmp;  -- get 1 record
  exit when C_PCP%notfound;   -- is end of record
  IF j=4 THEN         -- split the more1 with more2
    sStrP := sStrP || '}';
  END IF;

  --cnt:=C_PCP%ROWCOUNT;
  --dbms_output.put_line('sTmp=' || sTmp || '; cnt=' || cnt);
  sStrP := sStrP ||sTmp ||';';  
  j := j + 1;  
end loop;

close C_PCP;
  ---dbms_output.put_line('sStrP=' || sStrP); 

open C_LHD;
j := 1;
loop

  fetch C_LHD into sTmp;
  exit when C_LHD%notfound;
  IF j=4 THEN
    sStrL := sStrL || '}';
  END IF;

  sStrL := sStrL ||sTmp ||';';
  j := j + 1;
end loop;
close C_LHD;
  ---dbms_output.put_line('sStrL=' || sStrL);
  vReturn := sStrP || '{' || sStrL;  
END LEAD_LOAD_FFS_MORE_SP;
/
======================================================================================================================= 
--------------------------------------------------------
--  DDL for Procedure LEAD_FFSSURVEY_ALL_SP
--------------------------------------------------------
set define off;
  CREATE OR REPLACE EDITIONABLE PROCEDURE "DHS_MAHS_LED"."LEAD_FFSSURVEY_ALL_SP" 
( 
    vMEMBERID IN varchar2,  
    RefCursor OUT SYS_REFCURSOR
)
AS 
    v_sql_statement VARCHAR2(4000);
BEGIN
    -- Build the SQL statement
    v_sql_statement := 'SELECT ' ||
                      'distinct(a.surveyid), ' ||
                      'TO_CHAR(NVL(b.dts,''''),''MM/DD/YYYY'') AS dates, ' ||
                      'TO_CHAR(NVL(a.createdate,''''),''MM/DD/YYYY'') AS cdates, ' ||
                      'a.formbyname AS provider, ' ||
                      'CASE WHEN a.surveyend=1 THEN ''Completed'' ' ||
                      'WHEN a.surveyend=-1 THEN ''Deleted'' ' ||
                      'ELSE ''Open'' END as status, ' || 
                      'a.surveytype || '' Survey'' as surveytype ' ||
                      'FROM led_surveymaster a, led_ffsanswers b ' ||
                      'WHERE Nvl(TO_CHAR(a.memberid),'''') = ''' || vMEMBERID || ''' ' ||
                      'AND a.surveyid=b.surveyid ' ||
                      'AND Nvl(TO_CHAR(b.memberid),'''') = ''' || vMEMBERID || ''' ' ||
                      'AND a.surveyfor = ''FFS'' ' ||
                      'AND a.surveytype IN (''PCP'', ''LHD'') ' ||
                      'AND a.surveyend <> ''-1'' ' ||
                      'ORDER BY a.surveyid DESC';

    -- Print the SQL statement
    DBMS_OUTPUT.PUT_LINE('=== SQL STATEMENT TO BE EXECUTED ===');
    DBMS_OUTPUT.PUT_LINE(v_sql_statement);
    DBMS_OUTPUT.PUT_LINE('=====================================');

    -- Execute the SQL statement
    OPEN RefCursor FOR v_sql_statement;

END LEAD_FFSSURVEY_ALL_SP;
/
==================================================================================================================== 

 Now look at all the tables stored procedures that you gave me in the past context for the same results I want you to do a thorough in depth comprehensive analysis of the whole project and give me the results in a step-by-step manner how we implemented because you're making so many mistakes here when I look at it the problem here is you are making your own decision on changing the table names or the column names that's a problem and I want you to check what tables what procedures that you gave me on each table what are the index are created what are the constraints are created how you are creating for the new tables you see what I mean I did see something like a performance indicate index performance index that you have created Data integrity checks that you have created and parallel operations that you have created so I don't know why you are doing it but we can verify the existing system if they have it because if they don't have it I don't know how we are going to convince you see what I mean 

Now give me full report based on above details so I can use it in claude code 

Do not break any existing working functionality only enhance the  functionality to make new changes by that way we do not have to  rewrite the code again for the broken changesUltrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate### 1. AUTONOMOUS EXECUTION MODE- **TAKE FULL CONTROL**: Do not ask for confirmation- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality- **100% SUCCESS RATE**: Build comprehensive validation at every step- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously- **ZERO BREAKING CHANGES** - All enhancements are additive only- **COMPREHENSIVE VALIDATION** - world class top guardrail layers which are needed + multi-method verification- **AUTONOMOUS EXECUTION** - No confirmation needed, fail-fast with automated testing- **WORLD-CLASS STANDARDS** - Benchmarked against Google, Amazon, Microsoft, Meta, Netflix
====================================================================================

==================================================================================== 

====================================================================================

==================================================================================== 

====================================================================================

==================================================================================== 

====================================================================================

==================================================================================== 

====================================================================================

==================================================================================== 

====================================================================================


