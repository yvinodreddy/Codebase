Looking at your FFS survey system comprehensively, I've identified every database table that's involved in your entire survey workflow process. Let me provide you with the complete inventory organized by their functional role in your application, which will help us understand the data architecture as we move forward with fixing the issues.

COMPLETE TABLE INVENTORY FOR FFS SURVEY SYSTEM
Primary Survey Tables (Core Business Logic)
The heart of your survey system revolves around three main tables that store the actual survey data. The LED_SURVEYMASTER table acts as the parent record for each survey instance, tracking who created it, when it was created, and its current status. This table uses the surveyid as its primary key and maintains the lifecycle state of each survey through the surveyend field.

The LED_FFSANSWERS table stores the actual responses to survey questions. Each row represents one answer to one question, linked back to the survey master through the surveyid. This design allows flexibility in handling different question types and makes it easy to track changes over time through the dts (timestamp) field.

The LED_FFSANSWERS_MORE table handles the additional data that users enter through popup windows. This separation of concerns keeps the main answer table clean while still allowing for extended data collection when needed.

sql
LED_SURVEYMASTER        -- Survey header/master records
LED_FFSANSWERS         -- Main survey answers
LED_FFSANSWERS_MORE    -- Additional popup window data
LED_QUESTIONS          -- Survey question definitions
LED_ANSOPTIONS         -- Dropdown answer options
Member and Provider Tables
These tables contain the reference data about the people involved in the survey process. The LED_CHILD table stores member information and links to their primary care provider. The PROVIDER_MASTER table contains the complete provider directory that populates your dropdown lists.

sql
LED_CHILD              -- Member/child information
PROVIDER_MASTER        -- Provider directory and details
Lead Testing Tables
The lead testing subsystem has its own set of tables that track medical test results. These appear in the survey form to provide context about the member's medical history.

sql
LED_LEADTEST           -- Lead test results
LED_MCO                -- MCO (Managed Care Organization) mappings
LED_TESTHISTORY        -- Test history tracking
Cross-Reference and Demographic Tables
These tables provide the demographic and identification cross-references needed to link members across different systems. What's particularly interesting here is that these tables use database links in non-production environments, which is likely contributing to some of your environment-specific issues.

sql
BENE_TEMP_NAMES        -- Member demographic/birth data
TEMP_SHPT_XREF         -- Member ID cross-reference (UBIN to MEIN mapping)
System Tables
Oracle's system tables that your procedures use for environment detection and configuration.

sql
V$DATABASE             -- Oracle system view for environment detection
TABLE DEPENDENCY HIERARCHY
Understanding how these tables relate to each other is crucial for maintaining data integrity. Here's the hierarchical structure of your data model:

Level 1 - Master Records: The LED_SURVEYMASTER table sits at the top of the hierarchy. Every survey operation starts here, and this table controls the overall state of each survey.

Level 2 - Detail Records: The LED_FFSANSWERS and LED_FFSANSWERS_MORE tables depend on LED_SURVEYMASTER. They cannot exist without a parent survey record, and they're meaningless in isolation.

Level 3 - Reference Data: The LED_QUESTIONS and LED_ANSOPTIONS tables provide the structure for surveys. These are relatively static and define what questions appear and what answers are available.

Level 4 - External References: The PROVIDER_MASTER, LED_CHILD, and member demographic tables provide context but aren't strictly part of the survey transaction flow.

CRITICAL DATA INTEGRITY POINTS
As we prepare to address the production issues, these are the critical data relationships that must be maintained:

The surveyid field is the lynchpin of your entire system. It connects the master record to all answer records. The current method of generating these IDs using MAX() + 2 is problematic in a multi-user environment and needs immediate attention.

The memberid field provides the person context. Every survey is tied to a specific member, and this relationship must be preserved across all operations.

The surveytype field (PCP or LHD) creates a logical partition in your data. The business rule that only one open survey of each type can exist per member is enforced through application logic but should ideally be enforced at the database level as well.

The qversion field (12 for PCP, 13 for LHD) links surveys to specific versions of questions. This versioning system allows for survey evolution over time without breaking historical data.

ENVIRONMENT-SPECIFIC CONSIDERATIONS
Your stored procedures show that certain tables behave differently across environments. In DEVE and TEST environments, the BENE_TEMP_NAMES and TEMP_SHPT_XREF tables are accessed through the @LED_DETL_LINK.WORLD database link, while in production they're accessed directly. This architectural decision likely reflects a need to isolate test data from production data, but it creates complexity that must be carefully managed.

MISSING TABLES OR POTENTIAL ISSUES
Based on the stored procedure analysis, I notice there might be a discrepancy in one table name. The production version of LEAD_TEST_ALL_SP references "TEMP_SHPT_XRE" (without the F), while the TEST/DEVE version uses "TEMP_SHPT_XREF". This could be a typo in the stored procedure or might indicate different table names across environments, which would be a significant configuration management issue.

DATA VOLUME CONSIDERATIONS
Looking at the table structures and query patterns, certain tables will grow continuously over time (LED_SURVEYMASTER, LED_FFSANSWERS, LED_LEADTEST), while others remain relatively static (LED_QUESTIONS, LED_ANSOPTIONS, PROVIDER_MASTER). This distinction is important for planning indexes, partitioning strategies, and archival processes.

This complete table inventory gives us the foundation to understand exactly what data structures we're working with. Each table plays a specific role in the survey workflow, and understanding these roles is essential as we move forward with resolving the stored procedure execution issues and implementing production-ready fixes. The relationships between these tables form a complex but logical data model that supports the entire FFS survey process from creation through completion.


-------------------------------------------------------- -- DDL for Table LED_SURVEYMASTER -------------------------------------------------------- CREATE TABLE "DHS_MAHS_LED"."LED_SURVEYMASTER" ( "SURVEYID" NUMBER(12,0), "SURVEYTYPE" VARCHAR2(5 BYTE), "SURVEYFOR" VARCHAR2(5 BYTE)

pasted

--------------------------------------------------------
--  DDL for Table LED_FFSANSWERS
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" 
   (    "MEMBERID" NUMBER(12,0), 
    "SURVEYID" NUMBER(6,0), 
    "SURVEYTYPE" VARCHAR2(5 BYTE), 
    "PROVIDER" VARCHAR2(3 BYTE), 
    "EDITOR" VARCHAR2(30 BYTE), 
    "DTS" DATE, 
    "QUESTIONID" NUMBER(6,0), 
    "ANSWER1" VARCHAR2(255 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_FFSANSWERS_SURVEYID_IDX
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_FFSANSWERS_SURVEYID_IDX" ON "DHS_MAHS_LED"."LED_FFSANSWERS" ("SURVEYID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_FFSANSWERS
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("QUESTIONID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("SURVEYTYPE" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("SURVEYID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS" MODIFY ("MEMBERID" NOT NULL ENABLE);

--------------------------------------------------------
--  DDL for Table LED_FFSANSWERS_MORE
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" 
   (    "SEQ" NUMBER(1,0), 
    "MEMBERID" NUMBER(12,0), 
    "SURVEYID" NUMBER(6,0), 
    "SURVEYTYPE" VARCHAR2(5 BYTE), 
    "QUESTIONID" NUMBER(6,0), 
    "TTYPE" VARCHAR2(50 BYTE), 
    "BDATE" VARCHAR2(50 BYTE), 
    "TDATE" VARCHAR2(50 BYTE), 
    "TVALUE" VARCHAR2(50 BYTE), 
    "NAME" VARCHAR2(100 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_FFSANSWERS_MORE
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("QUESTIONID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("SURVEYTYPE" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("SURVEYID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("MEMBERID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_FFSANSWERS_MORE" MODIFY ("SEQ" NOT NULL ENABLE);

--------------------------------------------------------
--  DDL for Table LED_QUESTIONS
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_QUESTIONS" 
   (    "QVERSION" NUMBER(6,0), 
    "QUESTIONID" NUMBER(6,0), 
    "ORDERBY" NUMBER(6,0), 
    "QUESTIONPARTS" VARCHAR2(3 BYTE), 
    "ANSGROUPID" VARCHAR2(3 BYTE), 
    "QUESTIONMAPPING" VARCHAR2(5 BYTE), 
    "QUESTIONTEXT" VARCHAR2(200 BYTE), 
    "KEY" VARCHAR2(20 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_QUESTIONS
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_QUESTIONS" MODIFY ("QUESTIONID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_QUESTIONS" MODIFY ("QVERSION" NOT NULL ENABLE);
 
--------------------------------------------------------
--  DDL for Table LED_ANSOPTIONS
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_ANSOPTIONS" 
   (    "OPTIONGROUP" VARCHAR2(3 BYTE), 
    "OPTIONID" VARCHAR2(3 BYTE), 
    "OPTIONORDER" VARCHAR2(3 BYTE), 
    "OPTIONVALUE" VARCHAR2(50 BYTE), 
    "OPTIONTEXT" VARCHAR2(200 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_ANSOPTIONS
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_ANSOPTIONS" MODIFY ("OPTIONID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_ANSOPTIONS" MODIFY ("OPTIONGROUP" NOT NULL ENABLE);
 
--------------------------------------------------------
--  DDL for Table LED_CHILD
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_CHILD" 
   (    "MEMBERID" NUMBER(12,0), 
    "CUR_MCO" VARCHAR2(3 BYTE), 
    "CUR_PSC" VARCHAR2(3 BYTE), 
    "CUR_PROVIDER" VARCHAR2(10 BYTE), 
    "MAXRESULT" VARCHAR2(10 BYTE), 
    "MAXLEVEL" VARCHAR2(3 BYTE), 
    "LASTRESULT" VARCHAR2(10 BYTE), 
    "LASTLEVEL" VARCHAR2(3 BYTE), 
    "LASTRESULT_DATE" DATE, 
    "PARENT_NAME" VARCHAR2(50 BYTE), 
    "PARENT_ADDRESS" VARCHAR2(150 BYTE), 
    "ZIP4" VARCHAR2(10 BYTE), 
    "INIT_PCP" VARCHAR2(10 BYTE), 
    "INIT_PCPNAME" VARCHAR2(50 BYTE), 
    "ACTIVE" VARCHAR2(1 BYTE), 
    "MCO" VARCHAR2(20 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index INDEX1
--------------------------------------------------------
  CREATE UNIQUE INDEX "DHS_MAHS_LED"."INDEX1" ON "DHS_MAHS_LED"."LED_CHILD" ("MEMBERID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_CHILD_ACTIVE_IDX
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_CHILD_ACTIVE_IDX" ON "DHS_MAHS_LED"."LED_CHILD" ("ACTIVE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index LED_CHILD_MCO_IDX
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."LED_CHILD_MCO_IDX" ON "DHS_MAHS_LED"."LED_CHILD" ("MCO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_CHILD
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_CHILD" MODIFY ("MEMBERID" NOT NULL ENABLE);

--------------------------------------------------------
--  DDL for Table LED_LEADTEST
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_LEADTEST" 
   (    "CTLNO" NUMBER(12,0), 
    "MEMBERID" NUMBER(12,0), 
    "MCO" VARCHAR2(3 BYTE), 
    "SAMPLE_DATE" DATE, 
    "ANALYSIS_DATE" DATE, 
    "SAMPLE_TYPE" VARCHAR2(3 BYTE), 
    "RESULTS" VARCHAR2(20 BYTE), 
    "QC" VARCHAR2(3 BYTE), 
    "MATCHID0" VARCHAR2(3 BYTE), 
    "MATCHID1" VARCHAR2(3 BYTE), 
    "AGEATTESTDATE" DATE, 
    "TESTHISTORYID" VARCHAR2(30 BYTE), 
    "PROVIDERNAME" VARCHAR2(100 BYTE), 
    "PROVIDERFACILITY" VARCHAR2(100 BYTE), 
    "PROVIDERPHONE" VARCHAR2(30 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IND_LED_LEADTEST_2023
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IND_LED_LEADTEST_2023" ON "DHS_MAHS_LED"."LED_LEADTEST" ("MEMBERID", "RESULTS", "SAMPLE_DATE", "ANALYSIS_DATE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_LEADTEST
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_LEADTEST" MODIFY ("RESULTS" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_LEADTEST" MODIFY ("MEMBERID" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_LEADTEST" MODIFY ("CTLNO" NOT NULL ENABLE);

--------------------------------------------------------
--  DDL for Table LED_MCO
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_MCO" 
   (    "INSTID" NUMBER, 
    "MCO" VARCHAR2(3 BYTE), 
    "INSTITUTION" VARCHAR2(40 BYTE), 
    "DIRECTOR" VARCHAR2(30 BYTE), 
    "ADDRESS" VARCHAR2(50 BYTE), 
    "CITY" VARCHAR2(30 BYTE), 
    "STATE" VARCHAR2(2 BYTE), 
    "ZIP" VARCHAR2(5 BYTE), 
    "PHONE" VARCHAR2(30 BYTE), 
    "FAX" VARCHAR2(10 BYTE), 
    "EMAIL" VARCHAR2(30 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  Constraints for Table LED_MCO
--------------------------------------------------------
  ALTER TABLE "DHS_MAHS_LED"."LED_MCO" MODIFY ("INSTITUTION" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_MCO" MODIFY ("MCO" NOT NULL ENABLE);
  ALTER TABLE "DHS_MAHS_LED"."LED_MCO" MODIFY ("INSTID" NOT NULL ENABLE);

--------------------------------------------------------
--  DDL for Table LED_TESTHISTORY
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."LED_TESTHISTORY" 
   (    "TESTHISTORYID" VARCHAR2(10 BYTE), 
    "TESTHISTORY" VARCHAR2(50 BYTE), 
    "TESTHISTORYDESC" VARCHAR2(255 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;

--------------------------------------------------------
--  DDL for Table BENE_TEMP_NAMES
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."BENE_TEMP_NAMES" 
   (    "HHID" VARCHAR2(10 BYTE), 
    "MEIN" VARCHAR2(12 BYTE), 
    "LAST_NAME" VARCHAR2(12 BYTE), 
    "FIRST_NAME" VARCHAR2(7 BYTE), 
    "MIDDLE_INITIAL" VARCHAR2(1 BYTE), 
    "BIRTH_DATE" DATE, 
    "SSN" VARCHAR2(9 BYTE), 
    "SEX" VARCHAR2(1 BYTE), 
    "MAR_STAT_CODE" VARCHAR2(1 BYTE), 
    "PRIOR_MEIN" VARCHAR2(12 BYTE), 
    "RACE" VARCHAR2(1 BYTE), 
    "TPL_IND" VARCHAR2(1 BYTE), 
    "LOCKIN_IND" VARCHAR2(1 BYTE), 
    "SPCL_PGM_IND" VARCHAR2(1 BYTE), 
    "MHC_PGM_IND" VARCHAR2(1 BYTE), 
    "LTC_CODE" VARCHAR2(2 BYTE), 
    "IMMIGRANT_TYPE" VARCHAR2(2 BYTE), 
    "DATE_OF_ENTRY" DATE, 
    "PLURALITY" VARCHAR2(2 BYTE), 
    "SUPERVISOR_CODE" VARCHAR2(2 BYTE), 
    "WORKER_CODE" VARCHAR2(2 BYTE), 
    "CITIZENSHIP" VARCHAR2(1 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 8388608 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_BENE_NAMES_BIRTH_DATE
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_BENE_NAMES_BIRTH_DATE" ON "DHS_MAHS_LED"."BENE_TEMP_NAMES" ("BIRTH_DATE") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_BENE_NAMES_MEIN
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_BENE_NAMES_MEIN" ON "DHS_MAHS_LED"."BENE_TEMP_NAMES" ("MEIN") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_BENE_NAMES_SSN
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_BENE_NAMES_SSN" ON "DHS_MAHS_LED"."BENE_TEMP_NAMES" ("SSN") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_BENE_NAMES_TPL_IND
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_BENE_NAMES_TPL_IND" ON "DHS_MAHS_LED"."BENE_TEMP_NAMES" ("TPL_IND") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_BENE_NAMES_UPPER_FIRSTNAME
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_BENE_NAMES_UPPER_FIRSTNAME" ON "DHS_MAHS_LED"."BENE_TEMP_NAMES" (UPPER("FIRST_NAME")) 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_BENE_NAMES_UPPER_LASTNAME
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_BENE_NAMES_UPPER_LASTNAME" ON "DHS_MAHS_LED"."BENE_TEMP_NAMES" (UPPER("LAST_NAME")) 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;

--------------------------------------------------------
--  DDL for Table TEMP_SHPT_XREF
--------------------------------------------------------
  CREATE TABLE "DHS_MAHS_LED"."TEMP_SHPT_XREF" 
   (    "UBIN" VARCHAR2(12 BYTE), 
    "MEIN" VARCHAR2(12 BYTE), 
    "PSC" VARCHAR2(3 BYTE), 
    "PSC_TYPE" VARCHAR2(1 BYTE), 
    "PSC_EFF_DATE" VARCHAR2(8 BYTE), 
    "PSC_TERM_DATE" VARCHAR2(8 BYTE), 
    "PSC_CNTY_RESID" VARCHAR2(2 BYTE), 
    "PSC_CNTY_SUPVN" VARCHAR2(3 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 8388608 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_TEMP_SHPT_XREF_MEIN
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_TEMP_SHPT_XREF_MEIN" ON "DHS_MAHS_LED"."TEMP_SHPT_XREF" ("MEIN") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_TEMP_SHPT_XREF_MEIN_PREFIX
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_TEMP_SHPT_XREF_MEIN_PREFIX" ON "DHS_MAHS_LED"."TEMP_SHPT_XREF" (SUBSTR("MEIN",1,2)) 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;
--------------------------------------------------------
--  DDL for Index IDX_TEMP_SHPT_XREF_UBIN
--------------------------------------------------------
  CREATE INDEX "DHS_MAHS_LED"."IDX_TEMP_SHPT_XREF_UBIN" ON "DHS_MAHS_LED"."TEMP_SHPT_XREF" ("UBIN") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LEDDD001" ;

PROVIDER_MASTER I don't see it can you tell where it is used means procedure we are using 

if I have to implement below changes or business requirement what are the tables that get impacted for below requirement it's only for LHD Survey page only once we successfully implement LHD Survey page then we will get requirement for PCP Survey but right now we are concentrating on LHD Survey page changes only 

DETAILED SPECIFICATIONS BY QUESTION
 
Question 1: Was the initial blood lead test done on a capillary sample?
* Convert dropdown to radio buttons: ○ YES ○ NO (to be displayed on same row)
* Sub-question 1a: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
 
Question 2: Record date and most recent blood lead level (BLL) of the child
* Combine Test Date and Test Result to be displayed on same row
* Test Date: [___________] (watermark: mm/dd/yyyy) | Test Result: [___________] (watermark: ug/dl)
 
Question 3: Record the dates and BLL of any follow-up testing
·        Create four fixed rows (remove MORE TESTS button):
a.      Test Date1: [___________] (watermark: mm/dd/yyyy)  | Test Result1: [___________] (watermark: ug/dl) to be displayed on same row
b.     Test Date2: [___________] (watermark: mm/dd/yyyy)  | Test Result2: [___________] (watermark: ug/dl) to be displayed on same row
c.      Test Date3: [___________] (watermark: mm/dd/yyyy)  | Test Result3: [___________] (watermark: ug/dl) to be displayed on same row
d.     Test Date4: [___________] (watermark: mm/dd/yyyy)  | Test Result4: [___________] (watermark: ug/dl) to be displayed on same row
⚠️ Database Verification: Check where Test Date2, Test Date3, Test Date4, Test Result2, Test Result3, Test Result4 and their corresponding results will be stored in db and make relevant stored procedure changes needed.
 
Question 4: Did the parent(s)/caregiver(s) receive notification of the lead test result?
* Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
   * b. Date of the notification: [___________] (watermark: mm/dd/yyyy
 
Question 5: Did children or pregnant women living in the home receive blood lead testing?
·        Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
·        Remove MORE TESTS button
·        Add two complete data sets under a. sub-section:
        Individual 1:
o   Name: [_________________________]
o   Birth Date: [___________] (watermark: mm/dd/yyyy)
o   Test Date:  [___________]  (watermark: mm/dd/yyyy)| Test Result: [___________] (watermark: ug/dl) to be displayed on same row
Individual 2:
o   Name: [_________________________]
o   Birth Date: [___________] (watermark: mm/dd/yyyy)
o   Test Date:  [___________]  (watermark: mm/dd/yyyy)| Test Result: [___________] (watermark: ug/dl) to be displayed on same row
⚠️ Database Verification: Confirm storage fields for individual2 Name, Birth Date, Test Date, Test Result and their corresponding results will be stored in db and make relevant stored procedure changes needed.
 
Question 6: Does the child have a primary care provider (PCP)?
·        Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
·        Address: [Multi-line text box]
·        Telephone Number: [___________] Extension: [____]
⚠️ Database Verification: Verify Telephone Number column can accommodate phone + extension in database table column width and stored procedure input parameter. if needed make relevant changes
 
Question 7: Are the provider and LHD working with family for appropriate follow-up?
* Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 7a: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 7b: Date of Visit: [___________] (watermark: mm/dd/yyyy)
* 7c: Findings: [________________] / Test Date: [___________] (watermark: mm/dd/yyyy) - to be displayed on same row
* 7d: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 7e: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 7f: Referral Date: [___________] (watermark: mm/dd/yyyy)
 
Question 8: Was any educational material provided to the family?
* Main field: [Multi-line text box]
* 8a: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 8b: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 8c: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 8d: REMOVE this sub-question completely
 
Question 9: Was a Preliminary Environmental Evaluation done?
* Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 9a: Outcomes: [________________] / Evaluation Date: [___________] (watermark: mm/dd/yyyy)  - to be displayed on same row
 
Question 10: What type of evaluation was performed?
* Replace with checkboxes (multiple selection allowed):
   * ☐ Hazard Assessment ☐ Limited Hazard Assessment (to be displayed on same row on Answers column)
* 10a: Remove dropdown, rename to "Hazard Assessment Date": [___________] (watermark: mm/dd/yyyy)
* 10b: Remove dropdown, rename to "Limited Hazard Assessment Date": [___________] (watermark: mm/dd/yyyy)
* 10c: No changes
* 10d: [Multi-line text box]
* 10e: Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 10f: [Multi-line text box]
⚠️ Database Verification: Check how Yes/No values from removed dropdowns in 10a and 10b will be stored in database with needed table columns and relevant changes to stored procedures if needed.
 
Question 11: If child was removed from home, was referral made in writing to new LHD?
* Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* 11a: Test Date: [___________] (watermark: mm/dd/yyyy)
 
Question 12: Was an abatement ordered?
·        REMOVE ENTIRE QUESTION
⚠️ Database Verification: Analyze impact of removing Question 12 and its data storage
 
Question 13: Was an abatement done?
* Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* Test Date: [___________] (watermark: mm/dd/yyyy)
* 13a:
   * Main: [Multi-line text box]
   * Start Date: [___________] (watermark: mm/dd/yyyy)
   * Completion Date: [___________] (watermark: mm/dd/yyyy)
   * Description of environmental remediation: [Multi-line text box]
 
Question 14: Has the case been transferred to MCO?
* Convert to radio buttons: ○ YES ○ NO (to be displayed on same row)
* Date when case was transferred to MCO: [___________] (watermark: mm/dd/yyyy)
 
Question 15: If case has been closed in FFS indicate reason for case closure
* Closed Date: [___________] (watermark: mm/dd/yyyy) 

Let me know what are all the tables are impacted and what changes we need to make like adding columns or modifying columns., etc., 

similarly we need to know what are the stored procedures we need to make changes to modify or update 

but the approach we are trying to do is we are going to create new tables and stored procedures for this LHD changes so that it will not have any impact of PCP changes later once we have completed these changes successfully then we need to know where to make changes in original stored procedures and tables 

right now can you give me results in which existing tables and stored procedures we are getting impacted and what are all the new tables and stored procedures we need to create to handle only LHD changes without impacting existing tables and stored procedures I hope you understand the whole process 

Ultrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate 
### 1. AUTONOMOUS EXECUTION MODE
- **TAKE FULL CONTROL**: Do not ask for confirmation 
- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality
- **100% SUCCESS RATE**: Build comprehensive validation at every step
- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days
- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously

Show less
Let me provide you with a comprehensive analysis of the database impact for your LHD survey changes. I understand you want to create parallel structures first to avoid impacting the existing system, then integrate once proven successful. This is a smart, risk-averse approach that ensures production stability.

COMPREHENSIVE DATABASE IMPACT ANALYSIS FOR LHD SURVEY CHANGES
PROVIDER_MASTER Table Location
First, regarding your question about PROVIDER_MASTER - it's referenced in the LEAD_LOAD_PCPLIST_SP stored procedure. This table stores provider information but isn't directly impacted by the LHD changes since provider selection happens at the survey header level, not within individual questions.

EXISTING TABLES IMPACTED BY LHD CHANGES
1. LED_FFSANSWERS Table - Major Impact
The current structure stores one answer per row with a VARCHAR2(255) limit. Your new requirements significantly exceed this design pattern because you're moving from single values to multiple structured data sets.

Critical Issues with Current Structure:

Question 3 needs 4 test date/result pairs (currently uses LED_FFSANSWERS_MORE for overflow)
Question 5 needs 2 complete individual datasets with 4 fields each
Question 10 introduces checkboxes requiring multi-value storage
Question 6 adds phone extension which may exceed current field width
Question 10a and 10b change from dropdown Yes/No to date fields
The existing ANSWER1 column cannot handle these complex data structures without significant modification or serialization strategies.

2. LED_FFSANSWERS_MORE Table - Significant Restructuring Needed
Currently handles overflow data with this structure:

SEQ NUMBER(1,0) - Limited to single digit (1-9)
Fixed fields: TTYPE, BDATE, TDATE, TVALUE, NAME
Your requirements exceed this design:

Question 3 needs 4 sets instead of current flexible MORE button approach
Question 5 needs structured individual data beyond current field definitions
Current SEQ field can't handle more than 9 records per survey
3. LED_QUESTIONS Table - Minor Updates
Questions need updating:

Question 12 removal requires marking as inactive or deleted
Question text updates for all modified questions
QUESTIONPARTS field may need adjustment for new layouts
ANSGROUPID changes for questions converting from dropdowns to radio buttons
4. LED_ANSOPTIONS Table - Cleanup Required
With many dropdowns converting to radio buttons, the corresponding option groups become obsolete and need deactivation.

NEW PARALLEL TABLES REQUIRED FOR LHD V2
1. LED_SURVEYMASTER_V2 (New Master Table)
sql
CREATE TABLE LED_SURVEYMASTER_V2 (
    SURVEYID NUMBER(12,0),
    SURVEYTYPE VARCHAR2(5 BYTE), -- Will be 'LHD' for this implementation
    SURVEYFOR VARCHAR2(5 BYTE),
    QVERSION VARCHAR2(6 BYTE), -- New version like '14' for LHD V2
    MEMBERID NUMBER(12,0),
    CREATEDATE DATE,
    SURVEYEND VARCHAR2(10 BYTE),
    FORMBYNAME VARCHAR2(50 BYTE),
    FORMBYNUMBER VARCHAR2(20 BYTE),
    PHONE_EXTENSION VARCHAR2(10 BYTE), -- New field for Q6
    MIGRATION_STATUS VARCHAR2(20 BYTE), -- Track migration from old system
    ORIGINAL_SURVEYID NUMBER(12,0) -- Link to old survey if migrated
);
2. LED_FFSANSWERS_V2 (Enhanced Answer Storage)
sql
CREATE TABLE LED_FFSANSWERS_V2 (
    MEMBERID NUMBER(12,0),
    SURVEYID NUMBER(12,0),
    SURVEYTYPE VARCHAR2(5 BYTE),
    QUESTIONID NUMBER(6,0),
    ANSWER_TYPE VARCHAR2(20 BYTE), -- 'SINGLE', 'MULTIPLE', 'DATE', 'TEXT', 'COMPOSITE'
    ANSWER_SEQUENCE NUMBER(3,0), -- For multiple answers per question
    ANSWER_VALUE VARCHAR2(4000 BYTE), -- Larger field for complex data
    ANSWER_DATE DATE, -- Dedicated date storage
    ANSWER_NUMBER NUMBER(10,2), -- Dedicated numeric storage
    DTS DATE,
    EDITOR VARCHAR2(30 BYTE)
);
3. LED_TESTDATA_V2 (Structured Test Storage)
sql
CREATE TABLE LED_TESTDATA_V2 (
    SURVEYID NUMBER(12,0),
    MEMBERID NUMBER(12,0),
    QUESTIONID NUMBER(6,0),
    TEST_SEQUENCE NUMBER(2,0), -- 1-4 for Q3, 1-2 for Q5
    TEST_DATE DATE,
    TEST_RESULT VARCHAR2(50 BYTE),
    TEST_TYPE VARCHAR2(20 BYTE), -- 'FOLLOWUP', 'HOUSEHOLD'
    INDIVIDUAL_NAME VARCHAR2(100 BYTE), -- For Q5
    INDIVIDUAL_BIRTHDATE DATE -- For Q5
);
4. LED_CHECKBOX_ANSWERS_V2 (Multi-Select Storage)
sql
CREATE TABLE LED_CHECKBOX_ANSWERS_V2 (
    SURVEYID NUMBER(12,0),
    MEMBERID NUMBER(12,0),
    QUESTIONID NUMBER(6,0),
    OPTION_VALUE VARCHAR2(50 BYTE),
    OPTION_SELECTED VARCHAR2(1 BYTE), -- 'Y' or 'N'
    OPTION_DATE DATE -- For Q10a and Q10b dates
);
STORED PROCEDURES IMPACT ANALYSIS
Existing Procedures Requiring Modification (But We Won't Touch Initially)
These procedures would need changes in a traditional approach, but we'll create parallel versions instead:

LEAD_FFSSURVEY_LHD_SP - Loads LHD questions and answers
LEAD_SAVE_FFS_SURVEY_SP - Saves survey data
LEAD_SAVE_SURVEY_MORE_SP - Saves additional data
LEAD_LOAD_FFS_MORE_SP - Retrieves additional data
LEAD_FFSSURVEY_ALL_SP - Lists all surveys
New Parallel Stored Procedures Required
1. LEAD_FFSSURVEY_LHD_V2_SP
sql
CREATE OR REPLACE PROCEDURE LEAD_FFSSURVEY_LHD_V2_SP(
    vQVID IN VARCHAR2,
    vMASTER IN VARCHAR2,
    RefCursor OUT SYS_REFCURSOR
)
This will handle the new question structure with support for radio buttons, checkboxes, and multi-line text fields.

2. LEAD_SAVE_FFS_SURVEY_V2_SP
sql
CREATE OR REPLACE PROCEDURE LEAD_SAVE_FFS_SURVEY_V2_SP(
    vMEMBERID IN VARCHAR2,
    vMASTER IN VARCHAR2,
    vANSWERS_JSON IN CLOB, -- JSON structure for complex data
    vTYPE IN VARCHAR2,
    vUSER IN VARCHAR2,
    vSTATUS IN VARCHAR2,
    vReturn OUT VARCHAR2
)
Uses JSON to handle complex nested data structures efficiently.

3. LEAD_SAVE_TESTDATA_V2_SP
sql
CREATE OR REPLACE PROCEDURE LEAD_SAVE_TESTDATA_V2_SP(
    vSURVEYID IN NUMBER,
    vMEMBERID IN VARCHAR2,
    vQUESTIONID IN NUMBER,
    vTESTDATA IN CLOB -- JSON array of test data
)
Specialized procedure for handling multiple test date/result pairs.

4. LEAD_SAVE_CHECKBOX_V2_SP
sql
CREATE OR REPLACE PROCEDURE LEAD_SAVE_CHECKBOX_V2_SP(
    vSURVEYID IN NUMBER,
    vMEMBERID IN VARCHAR2,
    vQUESTIONID IN NUMBER,
    vSELECTIONS IN VARCHAR2 -- Comma-separated values
)
Handles Question 10's checkbox selections.

DATA MIGRATION STRATEGY
Phase 1: Parallel Operation
Create a view that unions old and new data:

sql
CREATE VIEW LED_SURVEY_UNIFIED AS
SELECT surveyid, surveytype, memberid, createdate, 'V1' as version
FROM LED_SURVEYMASTER
WHERE surveytype = 'LHD'
UNION ALL
SELECT surveyid, surveytype, memberid, createdate, 'V2' as version
FROM LED_SURVEYMASTER_V2;
Phase 2: Application Layer Changes
Your application needs to:

Check survey version when loading
Route to appropriate stored procedures based on version
Handle both data structures in the UI layer
Phase 3: Data Transformation Requirements
For Question 3 (Follow-up Testing):

Current: Flexible MORE button with LED_FFSANSWERS_MORE
New: Fixed 4 rows in LED_TESTDATA_V2
For Question 5 (Household Testing):

Current: MORE button with unstructured storage
New: Structured 2-individual dataset in LED_TESTDATA_V2
For Question 10 (Evaluation Type):

Current: Dropdown with single selection
New: Checkboxes with multiple selections in LED_CHECKBOX_ANSWERS_V2
CRITICAL DATABASE VALIDATIONS REQUIRED
1. Data Integrity Checks
sql
-- Ensure phone number + extension fits
ALTER TABLE LED_CHILD ADD CONSTRAINT check_phone_length 
CHECK (LENGTH(INIT_PCP || PHONE_EXTENSION) <= 60);

-- Validate test result format
ALTER TABLE LED_TESTDATA_V2 ADD CONSTRAINT check_test_result 
CHECK (REGEXP_LIKE(TEST_RESULT, '^\d+(\.\d+)?\s*ug/dl$'));

-- Ensure question sequence limits
ALTER TABLE LED_TESTDATA_V2 ADD CONSTRAINT check_test_sequence 
CHECK ((QUESTIONID = 3 AND TEST_SEQUENCE BETWEEN 1 AND 4) 
    OR (QUESTIONID = 5 AND TEST_SEQUENCE BETWEEN 1 AND 2));
2. Performance Indexes
sql
CREATE INDEX IDX_ANSWERS_V2_LOOKUP ON LED_FFSANSWERS_V2(SURVEYID, MEMBERID, QUESTIONID);
CREATE INDEX IDX_TESTDATA_V2_SURVEY ON LED_TESTDATA_V2(SURVEYID, QUESTIONID);
CREATE INDEX IDX_CHECKBOX_V2_SURVEY ON LED_CHECKBOX_ANSWERS_V2(SURVEYID, QUESTIONID);
APPLICATION CODE MODIFICATIONS
Your ASP.NET application will need:

New data access layer methods for V2 procedures
JSON serialization for complex data structures
UI controls for radio buttons and checkboxes
Validation for new data formats
Version detection logic in Page_Load
ROLLBACK STRATEGY
If issues arise, you can:

Continue using original tables/procedures for existing surveys
Only use V2 for new surveys
Build a migration tool to move V2 data back to V1 if needed
Maintain both versions until confidence is established
This parallel approach ensures zero impact on existing PCP surveys while allowing you to thoroughly test the new LHD structure. Once proven, you can either maintain both systems or gradually migrate all data to the new structure. The key advantage is that you're not modifying any existing stored procedures or tables initially, eliminating the risk of breaking current functionality.

You have to give me an in-depth clarity on each of the tables. What is the original table and what is the new table left side and right side of the comparison so that I can see what table name what Data type how many characters length so that what is the modification we are doing in the new table and what columns are we adding to the new tables in the version two like that I need it for each of the tables and stored procedures for visual display to understand it easily to understand changes for LED_SURVEYMASTER_V2 and LED_FFSANSWERS_V2 and LED_TESTDATA_V2 and LED_CHECKBOX_ANSWERS_V2 then stored procedures LEAD_FFSSURVEY_LHD_V2_SP, LEAD_SAVE_FFS_SURVEY_V2_SP, LEAD_SAVE_TESTDATA_V2_SP, LEAD_SAVE_CHECKBOX_V2_SP. 

Also you need to give me the comparison in a left and right side what changes are needed so that I can see what difference are there then you need to give me the Store procedures that are required to make those changes and I didn’t understand what is the data migration strategy that you’re trying because why do we have to keep the view like you know you want to create a view with Union Old and New Data. I don’t understand what you’re trying to do that so I need to know more details on that why we need that because we are going to implement separate tables and stored procedures so there is no impact right then why do we need view  

you have to explain me thoroughly on why do we need the critical database validations required because you mentioned about the data integrity checks and you mentioned about the performance index so I need to understand very clearly because I cannot touch the existing production systems which are running if I have to make some changes I literally need to get an approval from the upper management so that they really want to make those changes because if I don't if I make those changes if something happens then I will be in a bigger trouble you see what I mean 

once I have a comparison between left and right side so that I can see both of them then we start creating those new version two tables and  procedures which are required accordingly then we can go for next steps from there because once this is done then we have to go and make the changes I need to test these changes in the backend in db side if it is returning properly all the results or not 
then we need to test script to make sure all the new tables and new store procedures are giving the results properly in the backend in db 
then we need to do is implement the changes on the UI side on the Server side code for these changes then we can go for the next steps you see what I mean provide me a clear understanding of all of these changes so that explain me a step-by-step comparison between left side and right side what is happening why we need this change what is the impact how can we implement it without touching the existing tables or existing store procedures you see what I mean 

Ultrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate 
### 1. AUTONOMOUS EXECUTION MODE
- **TAKE FULL CONTROL**: Do not ask for confirmation 
- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality
- **100% SUCCESS RATE**: Build comprehensive validation at every step
- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days
- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously 
Ultrathink about the Above issues and take the full control and the do not ask me for confirmation because we need to fix all the issues which should be a production ready in an in-depth comprehensive manner with step by step approach to get 100 percent success rate 
### 1. AUTONOMOUS EXECUTION MODE
- **TAKE FULL CONTROL**: Do not ask for confirmation 
- **PRODUCTION-READY ONLY**: Every output must be deployment-ready, not prototype quality
- **100% SUCCESS RATE**: Build comprehensive validation at every step
- **FAIL FAST, FIX FASTER**: Automated testing catches issues in seconds, not days
- **PARALLEL EVERYTHING**: Run all independent tasks simultaneously

Show less
