@model RMMS.Models.Production.Machine
@{
    ViewData["Title"] = "Machine Details";
}

<div class="container">
    <h2><i class="fas @Model.TypeIcon"></i> @Model.MachineName</h2>
    <hr />

    <div class="row">
        <div class="col-md-8">
            <div class="card mb-3">
                <div class="card-header bg-primary text-white">
                    <h5>Machine Information</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-4">@Html.DisplayNameFor(model => model.MachineCode)</dt>
                        <dd class="col-sm-8"><strong>@Model.MachineCode</strong></dd>

                        <dt class="col-sm-4">@Html.DisplayNameFor(model => model.MachineName)</dt>
                        <dd class="col-sm-8">@Model.MachineName</dd>

                        <dt class="col-sm-4">@Html.DisplayNameFor(model => model.MachineType)</dt>
                        <dd class="col-sm-8">
                            <span class="badge bg-secondary">
                                <i class="fas @Model.TypeIcon"></i> @Model.MachineType
                            </span>
                        </dd>

                        <dt class="col-sm-4">@Html.DisplayNameFor(model => model.Status)</dt>
                        <dd class="col-sm-8">
                            <span class="badge @Model.StatusBadgeClass">
                                <i class="fas @Model.StatusIcon"></i> @Model.Status
                            </span>
                        </dd>

                        <dt class="col-sm-4">@Html.DisplayNameFor(model => model.Capacity)</dt>
                        <dd class="col-sm-8"><strong>@Model.CapacityDisplay</strong></dd>

                        <dt class="col-sm-4">Location</dt>
                        <dd class="col-sm-8">@Model.Location</dd>
                    </dl>
                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header bg-info text-white">
                    <h5>Specifications</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-4">Manufacturer</dt>
                        <dd class="col-sm-8">@Model.Manufacturer</dd>

                        <dt class="col-sm-4">Model Number</dt>
                        <dd class="col-sm-8">@Model.ModelNumber</dd>

                        @if (!string.IsNullOrEmpty(Model.Specifications))
                        {
                            <dt class="col-sm-4">Specifications</dt>
                            <dd class="col-sm-8">@Model.Specifications</dd>
                        }
                    </dl>
                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header bg-success text-white">
                    <h5>Purchase & Financial Information</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        @if (Model.PurchaseDate.HasValue)
                        {
                            <dt class="col-sm-4">Purchase Date</dt>
                            <dd class="col-sm-8">@Model.PurchaseDate.Value.ToString("dd-MMM-yyyy")</dd>
                        }

                        @if (Model.PurchasePrice.HasValue)
                        {
                            <dt class="col-sm-4">Purchase Price</dt>
                            <dd class="col-sm-8">₹@Model.PurchasePrice.Value.ToString("N2")</dd>
                        }

                        @if (Model.CurrentValue.HasValue)
                        {
                            <dt class="col-sm-4">Current Value</dt>
                            <dd class="col-sm-8">₹@Model.CurrentValue.Value.ToString("N2")</dd>
                        }

                        @if (Model.PurchasePrice.HasValue && Model.CurrentValue.HasValue)
                        {
                            <dt class="col-sm-4">Depreciation</dt>
                            <dd class="col-sm-8">
                                <strong class="text-danger">@Model.DepreciationPercent.ToString("N2")%</strong>
                            </dd>
                        }
                    </dl>
                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header bg-warning">
                    <h5>Maintenance Information</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-4">Running Hours</dt>
                        <dd class="col-sm-8"><strong>@Model.RunningHours.ToString("N0")</strong> hours</dd>

                        @if (Model.MaintenanceIntervalHours.HasValue)
                        {
                            <dt class="col-sm-4">Maintenance Interval</dt>
                            <dd class="col-sm-8">Every @Model.MaintenanceIntervalHours.Value.ToString("N0") hours</dd>
                        }

                        @if (Model.LastMaintenanceDate.HasValue)
                        {
                            <dt class="col-sm-4">Last Maintenance</dt>
                            <dd class="col-sm-8">@Model.LastMaintenanceDate.Value.ToString("dd-MMM-yyyy")</dd>
                        }

                        @if (Model.NextMaintenanceDue.HasValue)
                        {
                            <dt class="col-sm-4">Next Maintenance Due</dt>
                            <dd class="col-sm-8">
                                @Model.NextMaintenanceDue.Value.ToString("dd-MMM-yyyy")
                                @if (Model.IsMaintenanceDue)
                                {
                                    <span class="badge bg-danger ms-2">
                                        <i class="fas fa-exclamation-triangle"></i> DUE
                                    </span>
                                }
                            </dd>
                        }
                    </dl>
                </div>
            </div>

            @if (!string.IsNullOrEmpty(Model.Remarks))
            {
                <div class="card mb-3">
                    <div class="card-header">
                        <h5>Remarks</h5>
                    </div>
                    <div class="card-body">
                        <p>@Model.Remarks</p>
                    </div>
                </div>
            }

            <div class="card">
                <div class="card-header">
                    <h5>Audit Information</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-4">Created By</dt>
                        <dd class="col-sm-8">@Model.CreatedBy</dd>

                        <dt class="col-sm-4">Created Date</dt>
                        <dd class="col-sm-8">@Model.CreatedDate.ToString("dd-MMM-yyyy hh:mm tt")</dd>

                        @if (Model.ModifiedDate.HasValue)
                        {
                            <dt class="col-sm-4">Last Modified By</dt>
                            <dd class="col-sm-8">@Model.ModifiedBy</dd>

                            <dt class="col-sm-4">Last Modified Date</dt>
                            <dd class="col-sm-8">@Model.ModifiedDate?.ToString("dd-MMM-yyyy hh:mm tt")</dd>
                        }
                    </dl>
                </div>
            </div>

            <div class="mt-3 d-flex justify-content-between">
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Back to List
                </a>
                <div>
                    @if (Model.Status == "Maintenance" || Model.IsMaintenanceDue)
                    {
                        <a asp-action="Maintenance" asp-route-id="@Model.Id" class="btn btn-success">
                            <i class="fas fa-wrench"></i> Record Maintenance
                        </a>
                    }
                    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-warning">
                        <i class="fas fa-edit"></i> Edit
                    </a>
                    <a asp-action="Delete" asp-route-id="@Model.Id" class="btn btn-danger">
                        <i class="fas fa-trash"></i> Delete
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card bg-light">
                <div class="card-header">
                    <h5><i class="fas fa-info-circle"></i> Quick Stats</h5>
                </div>
                <div class="card-body">
                    <h6>Status</h6>
                    <span class="badge @Model.StatusBadgeClass mb-3">@Model.Status</span>

                    <h6>Type</h6>
                    <p><i class="fas @Model.TypeIcon"></i> @Model.MachineType</p>

                    <h6>Capacity</h6>
                    <p><strong>@Model.CapacityDisplay</strong></p>

                    @if (Model.IsMaintenanceDue)
                    {
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle"></i> <strong>Maintenance Due!</strong>
                        </div>
                    }

                    @if (Model.PurchasePrice.HasValue && Model.CurrentValue.HasValue)
                    {
                        <h6>Value</h6>
                        <p>
                            Current: ₹@Model.CurrentValue.Value.ToString("N0")<br>
                            Original: ₹@Model.PurchasePrice.Value.ToString("N0")<br>
                            <small class="text-danger">Depreciation: @Model.DepreciationPercent.ToString("N1")%</small>
                        </p>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
